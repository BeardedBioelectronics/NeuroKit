
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>EEG Microstates &#8212; NeuroKit2 0.2.4 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fit a function to a non-linear pattern" href="../misc_fit_function/misc_fit_function.html" />
    <link rel="prev" title="EEG Complexity Analysis" href="../eeg_complexity/eeg_complexity.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/neurokit.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Menu
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../introduction.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../authors.html">
   Authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cite_us.html">
   Cite us
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_eventrelated/bio_eventrelated.html">
     Event-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_intervalrelated/bio_intervalrelated.html">
     Interval-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_custom/bio_custom.html">
     Customize your Processing Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_hrv/ecg_hrv.html">
     Heart Rate Varability (HRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_heartbeats/ecg_heartbeats.html">
     Extract and Visualize Individual Heartbeats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_delineate/ecg_delineate.html">
     Locate P, Q, S and T waves in ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_edr/ecg_edr.html">
     ECG-Derived Respiration (EDR)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_generate_12leads/ecg_generate_12leads.html">
     Generating Abnormal 12-leads ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eda_peaks/eda_peaks.html">
     Analyze Electrodermal Activity (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../rsp_rrv/rsp_rrv.html">
     Respiratory Rate Variability (RRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eog_analyze/eog_analyze.html">
     Analyze Electrooculography (EOG)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../signal_simulation/signal_simulation.html">
     Simulate Artificial Physiological Signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ppg_report/ppg_report.html">
     Save Preprocessing Reports
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg_power/eeg_power.html">
     EEG Power in Frequency Bands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg_complexity/eeg_complexity.html">
     EEG Complexity Analysis
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     EEG Microstates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../misc_fit_function/misc_fit_function.html">
     Fit a function to a non-linear pattern
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../misc_epochs_create/misc_epochs_create.html">
     Create epochs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../functions/index.html">
   Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/bio.html">
     Bio
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/ecg.html">
     ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/ppg.html">
     PPG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/hrv.html">
     HRV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/rsp.html">
     RSP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eda.html">
     EDA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/emg.html">
     EMG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eog.html">
     EOG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eeg.html">
     EEG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/video.html">
     Video Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/microstates.html">
     Microstates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/signal.html">
     Signal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/events.html">
     Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/epochs.html">
     Epochs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/data.html">
     Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/complexity.html">
     Complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/markov.html">
     Markov Chains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/stats.html">
     Stats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/misc.html">
     Misc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/benchmark.html">
     Benchmarking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/index.html">
   Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/learn_python.html">
     Learn Python in 10 minutes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/contributing.html">
     Contributing guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/recording.html">
     Recording good quality signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/resources.html">
     Additional Resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../studies/index.html">
   Studies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">
     HRV Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/mwa6x/">
     HRV Indices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9307944/">
     HRV Tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1111/ejn.15800">
     Complexity Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.mdpi.com/1099-4300/24/8/1036">
     Complexity Indices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/complexity_eeg.html">
     EEG Complexity: Parameters Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/erp_gam.html">
     EEG Analysis with GAMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/ecg_benchmark.html">
     ECG Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/eog_blinktemplate.html">
     EOG blink template
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/neuropsychology/NeuroKit">
   Repository
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Fexamples/eeg_microstates/eeg_microstates.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs/examples/eeg_microstates/eeg_microstates.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/examples/eeg_microstates/eeg_microstates.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eeg-preprocessing">
   EEG Preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#microstates-analysis">
   Microstates Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimal-example">
     Minimal Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#options-and-features">
   Options and features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-field-power-gfp">
     Global Field Power (GFP)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-microstates">
     How many microstates?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microstates-clustering-algorithms">
     Microstates clustering algorithms
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>EEG Microstates</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eeg-preprocessing">
   EEG Preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#microstates-analysis">
   Microstates Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimal-example">
     Minimal Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#options-and-features">
   Options and features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-field-power-gfp">
     Global Field Power (GFP)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-microstates">
     How many microstates?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microstates-clustering-algorithms">
     Microstates clustering algorithms
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="eeg-microstates">
<h1>EEG Microstates<a class="headerlink" href="#eeg-microstates" title="Permalink to this headline">#</a></h1>
<p>In continually recorded human EEG, the spatial distribution of electric potentials across the cortex changes over time. Interestingly, for brief time periods (60 - 120ms), quasi-stable states of activity (i.e., <strong>microstates</strong>), characterized by unique spatial configurations of electrical activity distribution, have been observed. NeuroKit can be used to easily analyze them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the NeuroKit package and other useful packages</span>
<span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>
<span class="kn">import</span> <span class="nn">mne</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<section id="eeg-preprocessing">
<h2>EEG Preprocessing<a class="headerlink" href="#eeg-preprocessing" title="Permalink to this headline">#</a></h2>
<p>First, let’s download a raw eeg data in an <a class="reference external" href="https://mne.tools/stable/index.html">MNE</a> format and select teh EEG channels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s2">&quot;eeg_1min_200hz&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">pick</span><span class="p">([</span><span class="s2">&quot;eeg&quot;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>  <span class="c1"># Store the sampling rate</span>
</pre></div>
</div>
</div>
</div>
<p>EEG recordings measure the difference in electric potential between each electrode and a reference electrode. This means that the ideal reference electrode is one which records <strong>all</strong> the interfering noise from the environment but doesn’t pick up any fluctuating signals related to brain activity. The idea behind re-referencing is to express the voltage at the EEG scalp channels with respect to another, new reference. This “virtual reference” can be any recorded channel, or the average of all the channels, as we will use in the current analysis.</p>
<p>Below, we will apply a band-pass filter and re-reference the signals to remove power line noise, slow drifts and other large artifacts from the raw input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply band-pass filter (1-35Hz) and re-reference the raw signal</span>
<span class="n">eeg</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">eeg</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_rereference</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">)</span>

<span class="n">nk</span><span class="o">.</span><span class="n">signal_plot</span><span class="p">([</span><span class="n">raw</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">],</span> <span class="n">eeg</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">]],</span> 
               <span class="n">labels</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="s2">&quot;Preprocessed&quot;</span><span class="p">],</span> 
               <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">eeg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/48ffc1004dbb7ac60585345d2b794394c339ce8a4461e887b96a55405588b7f5.png" src="../../_images/48ffc1004dbb7ac60585345d2b794394c339ce8a4461e887b96a55405588b7f5.png" />
</div>
</div>
</section>
<section id="microstates-analysis">
<h2>Microstates Analysis<a class="headerlink" href="#microstates-analysis" title="Permalink to this headline">#</a></h2>
<section id="minimal-example">
<h3>Minimal Example<a class="headerlink" href="#minimal-example" title="Permalink to this headline">#</a></h3>
<p>Microstates can be extracted and analyzed like that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract microstates</span>
<span class="n">microstates</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">n_microstates</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Visualize the extracted microstates</span>
<span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/57f813b9dbb4b29035131b0a8138af30aa0c90e657c8070b1bd9c87fa118c5a8.png" src="../../_images/57f813b9dbb4b29035131b0a8138af30aa0c90e657c8070b1bd9c87fa118c5a8.png" />
</div>
</div>
<p>This shows the aspect of the microstates and their sequence in the Global Field Power (GFP; see below). We can then proceed to a statistical analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_static</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Microstate_0_Proportion</th>
      <th>Microstate_1_Proportion</th>
      <th>Microstate_2_Proportion</th>
      <th>Microstate_3_Proportion</th>
      <th>Microstate_0_LifetimeDistribution</th>
      <th>Microstate_1_LifetimeDistribution</th>
      <th>Microstate_2_LifetimeDistribution</th>
      <th>Microstate_3_LifetimeDistribution</th>
      <th>Microstate_0_DurationMean</th>
      <th>Microstate_0_DurationMedian</th>
      <th>Microstate_1_DurationMean</th>
      <th>Microstate_1_DurationMedian</th>
      <th>Microstate_2_DurationMean</th>
      <th>Microstate_2_DurationMedian</th>
      <th>Microstate_3_DurationMean</th>
      <th>Microstate_3_DurationMedian</th>
      <th>Microstate_Average_DurationMean</th>
      <th>Microstate_Average_DurationMedian</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.17625</td>
      <td>0.245833</td>
      <td>0.321583</td>
      <td>0.256333</td>
      <td>490.5</td>
      <td>683.0</td>
      <td>812.0</td>
      <td>741.0</td>
      <td>0.018264</td>
      <td>0.01</td>
      <td>0.018862</td>
      <td>0.015</td>
      <td>0.021802</td>
      <td>0.015</td>
      <td>0.01831</td>
      <td>0.015</td>
      <td>0.019443</td>
      <td>0.015</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/0cf089ee6bd008bae9857c6a2b2b74a54877bc9d8772482ed4118edf6612f008.png" src="../../_images/0cf089ee6bd008bae9857c6a2b2b74a54877bc9d8772482ed4118edf6612f008.png" />
</div>
</div>
<p>This shows computes static statistics, such as the prevalence of each microstates and the median duration time (also shown in the graph).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_dynamic</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Microstate_0_to_0</th>
      <th>Microstate_0_to_1</th>
      <th>Microstate_0_to_2</th>
      <th>Microstate_0_to_3</th>
      <th>Microstate_1_to_0</th>
      <th>Microstate_1_to_1</th>
      <th>Microstate_1_to_2</th>
      <th>Microstate_1_to_3</th>
      <th>Microstate_2_to_0</th>
      <th>Microstate_2_to_1</th>
      <th>Microstate_2_to_2</th>
      <th>Microstate_2_to_3</th>
      <th>Microstate_3_to_0</th>
      <th>Microstate_3_to_1</th>
      <th>Microstate_3_to_2</th>
      <th>Microstate_3_to_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.726241</td>
      <td>0.07565</td>
      <td>0.105437</td>
      <td>0.092671</td>
      <td>0.05322</td>
      <td>0.734915</td>
      <td>0.108136</td>
      <td>0.103729</td>
      <td>0.057269</td>
      <td>0.084478</td>
      <td>0.770666</td>
      <td>0.087587</td>
      <td>0.065366</td>
      <td>0.09626</td>
      <td>0.11122</td>
      <td>0.727154</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/92b20a759f46a80978bdb429b1c853a4cb59e4c3da1bdc0d7a9ad5952ca45f61.png" src="../../_images/92b20a759f46a80978bdb429b1c853a4cb59e4c3da1bdc0d7a9ad5952ca45f61.png" />
</div>
</div>
<p>Finally, one can compute complexity features of the sequence of microstates, such as the entropy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nk</span><span class="o">.</span><span class="n">microstates_complexity</span><span class="p">(</span><span class="n">microstates</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Microstates_Entropy_Shannon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.968773</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/ca4c5c2cc402806ec1242baf3aa251bdcbf7cb88a6c6d67eb37d5a8bab613eff.png" src="../../_images/ca4c5c2cc402806ec1242baf3aa251bdcbf7cb88a6c6d67eb37d5a8bab613eff.png" />
</div>
</div>
</section>
</section>
<section id="options-and-features">
<h2>Options and features<a class="headerlink" href="#options-and-features" title="Permalink to this headline">#</a></h2>
<section id="global-field-power-gfp">
<h3>Global Field Power (GFP)<a class="headerlink" href="#global-field-power-gfp" title="Permalink to this headline">#</a></h3>
<p>Under the hood, <code class="docutils literal notranslate"><span class="pre">microstates_segment()</span></code> starts by computing the GFP.</p>
<p>The Global Field Power (GFP) is a reference-independent measure of potential field strength. It is thought to quantify the integrated electrical activity of the brain and is mathematically defined as the standard deviation of all electrodes at a given time.</p>
<p>The GFP time series periodically shows peaks, where the EEG topographies are most clearly defined (i.e., signal-to-noise ratio is maximized at GFP peaks). As such, GFP peak samples are often used to extract microstates.</p>
<p>This can be visualized manually:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gfp</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">eeg_gfp</span><span class="p">(</span><span class="n">eeg</span><span class="p">)</span>

<span class="n">peaks</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_peaks</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">gfp</span><span class="o">=</span><span class="n">gfp</span><span class="p">)</span>

<span class="c1"># Plot the peaks in the first 200 data points</span>
<span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">(</span><span class="n">events</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="n">peaks</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">],</span> <span class="n">signal</span> <span class="o">=</span> <span class="n">gfp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0d61fbe8de8d132f64ea81b44fe1ac581b09b22a5dd76548368dbde52b589ff8.png" src="../../_images/0d61fbe8de8d132f64ea81b44fe1ac581b09b22a5dd76548368dbde52b589ff8.png" />
</div>
</div>
<p>By default, the microstates clustering algorithm is <strong>trained</strong> on the EEG activity at these peaks, and then applied to back-predict the state at all data points. However, this behaviour can be changed. For instance, one can decide to train the algorithm directly on all data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">microstates_all</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">n_microstates</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates_all</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7d93c526a7052e535a9e5e9f5ba88fbc599c887bcd999ca878b9b28a3c839e17.png" src="../../_images/7d93c526a7052e535a9e5e9f5ba88fbc599c887bcd999ca878b9b28a3c839e17.png" />
</div>
</div>
</section>
<section id="how-many-microstates">
<h3>How many microstates?<a class="headerlink" href="#how-many-microstates" title="Permalink to this headline">#</a></h3>
<p>Most of the clustering algorithms used in microstates analysis require the number of clusters to extract to be specified beforehand.</p>
<p>However, one can attempt at statistically estimating the optimal number of microstates. A variety of indices of fit can be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: we cropped the data as this function takes some time to compute </span>
<span class="n">n_optimal</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_findnumber</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal number of microstates: &quot;</span><span class="p">,</span> <span class="n">n_optimal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[........................................] 0/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[█████...................................] 1/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[███████████.............................] 2/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[█████████████████.......................] 3/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[██████████████████████..................] 4/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[████████████████████████████............] 5/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[██████████████████████████████████......] 6/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[████████████████████████████████████████] 7/7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal number of microstates:  5.0
</pre></div>
</div>
<img alt="../../_images/6fee88c65ae81a377b276a9fe2b3387ae6a6ca79a3348a0aa02ee980274a1fd0.png" src="../../_images/6fee88c65ae81a377b276a9fe2b3387ae6a6ca79a3348a0aa02ee980274a1fd0.png" />
</div>
</div>
</section>
<section id="microstates-clustering-algorithms">
<h3>Microstates clustering algorithms<a class="headerlink" href="#microstates-clustering-algorithms" title="Permalink to this headline">#</a></h3>
<p>Several different clustering algorithms can be used to segment your EEG recordings into microstates. These algorithms mainly differ in how they define cluster membership and the cost functionals to be optimized (<span class="xref myst">Xu &amp; Tian, 2015</span>). The method to use hence depends on your data and the underlying assumptions of the methods (e.g., some methods ignore polarity). There is no one true method that gives the best results but you can refer to <a class="reference external" href="https://www.researchgate.net/publication/331367421_Microstate_EEGlab_toolbox_An_introductory_guide#pf6">Poulsen et al., 2018</a> if you would like a more detailed review of the different clustering methods.</p>
<p>In the example below, we will compare the two most commonly applied clustering algorithms - the <em>K-means</em> and <em>modified K-means</em>. Other methods that can be applied using <code class="docutils literal notranslate"><span class="pre">nk.microstates_segment</span></code> include <code class="docutils literal notranslate"><span class="pre">kmedoids,</span> <span class="pre">pca,</span> <span class="pre">ica,</span> <span class="pre">aahc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract microstates</span>
<span class="n">microstates_kmeans</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">n_microstates</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">)</span>
<span class="n">microstates_kmod</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">microstates_segment</span><span class="p">(</span><span class="n">eeg</span><span class="p">,</span> <span class="n">n_microstates</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;kmod&quot;</span><span class="p">)</span>  

<span class="c1"># Global Explained Variance</span>
<span class="n">gev_kmeans</span> <span class="o">=</span> <span class="n">microstates_kmeans</span><span class="p">[</span><span class="s1">&#39;GEV&#39;</span><span class="p">]</span>
<span class="n">gev_kmod</span> <span class="o">=</span> <span class="n">microstates_kmod</span><span class="p">[</span><span class="s1">&#39;GEV&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39; Using conventional Kmeans,  GEV = </span><span class="si">{</span><span class="n">gev_kmeans</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39; Using modified Kmeans,  GEV = </span><span class="si">{</span><span class="n">gev_kmod</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

<span class="c1"># Visualize the extracted microstates</span>
<span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates_kmeans</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">450</span><span class="p">))</span>
<span class="n">nk</span><span class="o">.</span><span class="n">microstates_plot</span><span class="p">(</span><span class="n">microstates_kmod</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">450</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Using conventional Kmeans,  GEV = 61.88%
 Using modified Kmeans,  GEV = 72.07%
</pre></div>
</div>
<img alt="../../_images/2cc869aea868bc230147f8f667702282d139e6f355c8ea49e4dd017408208073.png" src="../../_images/2cc869aea868bc230147f8f667702282d139e6f355c8ea49e4dd017408208073.png" />
<img alt="../../_images/7a4ec420975dd8a6edfc83554659a87c89888191c0352333edfe7609f250f42e.png" src="../../_images/7a4ec420975dd8a6edfc83554659a87c89888191c0352333edfe7609f250f42e.png" />
</div>
</div>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../eeg_complexity/eeg_complexity.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">EEG Complexity Analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../misc_fit_function/misc_fit_function.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fit a function to a non-linear pattern</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a>. This documentation is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license.<br/>
  
      &copy; Copyright 2020–2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>